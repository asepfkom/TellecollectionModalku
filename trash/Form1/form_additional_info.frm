VERSION 5.00
Begin VB.Form form_additional_info 
   BorderStyle     =   1  'Fixed Single
   Caption         =   "Form Additional Info"
   ClientHeight    =   3750
   ClientLeft      =   45
   ClientTop       =   390
   ClientWidth     =   5670
   LinkTopic       =   "Form2"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   3750
   ScaleWidth      =   5670
   StartUpPosition =   3  'Windows Default
   Begin VB.Frame Frame1 
      BackColor       =   &H8000000B&
      Caption         =   "Additional Info"
      Height          =   3735
      Left            =   0
      TabIndex        =   0
      Top             =   0
      Width           =   5655
      Begin VB.TextBox Text1 
         Appearance      =   0  'Flat
         Height          =   375
         Index           =   7
         Left            =   1800
         TabIndex        =   16
         Top             =   3000
         Width           =   3495
      End
      Begin VB.TextBox Text1 
         Appearance      =   0  'Flat
         Height          =   375
         Index           =   6
         Left            =   1800
         TabIndex        =   15
         Top             =   2640
         Width           =   3495
      End
      Begin VB.TextBox Text1 
         Appearance      =   0  'Flat
         Height          =   375
         Index           =   5
         Left            =   1800
         TabIndex        =   14
         Top             =   2280
         Width           =   3495
      End
      Begin VB.TextBox Text1 
         Appearance      =   0  'Flat
         Height          =   375
         Index           =   4
         Left            =   1800
         TabIndex        =   13
         Top             =   1920
         Width           =   3495
      End
      Begin VB.TextBox Text1 
         Appearance      =   0  'Flat
         Height          =   375
         Index           =   3
         Left            =   1800
         TabIndex        =   12
         Top             =   1560
         Width           =   3495
      End
      Begin VB.TextBox Text1 
         Appearance      =   0  'Flat
         Height          =   375
         Index           =   2
         Left            =   1800
         TabIndex        =   11
         Top             =   1200
         Width           =   3495
      End
      Begin VB.TextBox Text1 
         Appearance      =   0  'Flat
         Height          =   375
         Index           =   1
         Left            =   1800
         TabIndex        =   10
         Top             =   840
         Width           =   3495
      End
      Begin VB.TextBox Text1 
         Appearance      =   0  'Flat
         Height          =   375
         Index           =   0
         Left            =   1800
         TabIndex        =   9
         Top             =   480
         Width           =   3495
      End
      Begin VB.Label Label1 
         BackColor       =   &H8000000A&
         Caption         =   "Info"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   7
         Left            =   240
         TabIndex        =   8
         Top             =   3000
         Width           =   1575
      End
      Begin VB.Label Label1 
         BackColor       =   &H8000000A&
         Caption         =   "Info"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   6
         Left            =   240
         TabIndex        =   7
         Top             =   2640
         Width           =   1575
      End
      Begin VB.Label Label1 
         BackColor       =   &H8000000A&
         Caption         =   "Info"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   5
         Left            =   240
         TabIndex        =   6
         Top             =   2280
         Width           =   1575
      End
      Begin VB.Label Label1 
         BackColor       =   &H8000000A&
         Caption         =   "Info"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   4
         Left            =   240
         TabIndex        =   5
         Top             =   1920
         Width           =   1575
      End
      Begin VB.Label Label1 
         BackColor       =   &H8000000A&
         Caption         =   "Info"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   3
         Left            =   240
         TabIndex        =   4
         Top             =   1560
         Width           =   1575
      End
      Begin VB.Label Label1 
         BackColor       =   &H8000000A&
         Caption         =   "Info"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   2
         Left            =   240
         TabIndex        =   3
         Top             =   1200
         Width           =   1575
      End
      Begin VB.Label Label1 
         BackColor       =   &H8000000A&
         Caption         =   "Info"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   1
         Left            =   240
         TabIndex        =   2
         Top             =   840
         Width           =   1575
      End
      Begin VB.Label Label1 
         BackColor       =   &H8000000A&
         Caption         =   "Info"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Index           =   0
         Left            =   240
         TabIndex        =   1
         Top             =   480
         Width           =   1575
      End
   End
End
Attribute VB_Name = "form_additional_info"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Sub Form_Load()
    Call visibles
    Call showaddinfo
End Sub

Private Sub Form_LostFocus()
    Unload Me
End Sub

Private Sub Text1_KeyPress(Index As Integer, KeyAscii As Integer)
    KeyAscii = 0
End Sub

Private Sub visibles()
    For i = 0 To 7
        Label1(i).Visible = False
        Text1(i).Visible = False
    Next i
End Sub

Private Sub showaddinfo()
    qs = "select distinct rekan from tbl_additional_info order by 1"
    Set M_objrsc = New ADODB.Recordset
    M_objrsc.CursorLocation = adUseClient
    M_objrsc.Open qs, M_OBJCONN, adOpenDynamic, adLockOptimistic
    
    For i = 1 To M_objrsc.RecordCount
        If UCase(FrmCC_Colection.lblRecsource.Caption) Like "*" & M_objrsc!rekan & "*" Then
            zzz = M_objrsc!rekan
        End If
        M_objrsc.MoveNext
    Next i

    c_str = " SELECT * From tbl_additional_info where rekan = '" & zzz & "' order by 1"
    Set crs = New ADODB.Recordset
    crs.CursorLocation = adUseClient
    crs.Open c_str, M_OBJCONN, adOpenKeyset, adLockReadOnly
    
    If crs.RecordCount > 0 Then
        For i = 1 To crs.RecordCount
            Label1(i - 1).Visible = True
            Text1(i - 1).Visible = True
            Label1(i - 1).Caption = crs!Caption
            'Text1(i - 1).text = cnull(crs!dbname)
            
            qs = "select * from tbl_setting_upload where field_destination = '" & cnull(crs!dbname) & "'"
            Set M_objrsc = New ADODB.Recordset
            M_objrsc.CursorLocation = adUseClient
            M_objrsc.Open qs, M_OBJCONN, adOpenDynamic, adLockOptimistic
            
            If M_objrsc.RecordCount > 0 Then
                Field = cnull(M_objrsc!field_source)
                
                qsc = "select " & Field & " from mgm where custid = '" & FrmCC_Colection.lblCustId.text & "'"
                Set rsc = New ADODB.Recordset
                rsc.CursorLocation = adUseClient
                rsc.Open qsc, M_OBJCONN, adOpenDynamic, adLockOptimistic
                
                Text1(i - 1).text = cnull(rsc(0))
                
            End If
            crs.MoveNext
        Next i
    End If
End Sub

Public Sub updatetblsettingupload(status As Boolean)
'dep_pay_code = other1
'deb_roll_pay_code = other2
'deb_roll_pay_code_bca = other3
'deb_over_due = other4
'deb_principal_amount = other5
'deb_int_amount = other6
'deb_delt_amount = other7
'deb_roll_over_amount = other8
'field_source, field_destination

    If status = True Then
        qupdate = "update tbl_setting_upload set field_destination = 'other1' where field_destination = 'dep_pay_code';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'other2' where field_destination = 'deb_roll_pay_code';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'other3' where field_destination = 'deb_roll_pay_code_bca';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'other4' where field_destination = 'deb_over_due';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'other5' where field_destination = 'deb_principal_amount';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'other6' where field_destination = 'deb_int_amount';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'other7' where field_destination = 'deb_delt_amount';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'other8' where field_destination = 'deb_roll_over_amount';" & vbCrLf
        M_OBJCONN.Execute qupdate
    Else
        qupdate = "update tbl_setting_upload set field_destination = 'dep_pay_code' where field_destination = 'other1';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'deb_roll_pay_code' where field_destination = 'other2';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'deb_roll_pay_code_bca' where field_destination = 'other3';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'deb_over_due' where field_destination = 'other4';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'deb_principal_amount' where field_destination = 'other5';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'deb_int_amount' where field_destination = 'other6';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'deb_delt_amount' where field_destination = 'other7';" & vbCrLf
        qupdate = qupdate & "update tbl_setting_upload set field_destination = 'deb_roll_over_amount' where field_destination = 'other8';" & vbCrLf
        M_OBJCONN.Execute qupdate
    End If
    MsgBox "berhasil diupdate"
    End
End Sub
